<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2026-01-06 周二 17:36 -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>为rime输入方案添加语言模型支持</title>
<meta name="generator" content="Org Mode" />
<link rel='stylesheet' type='text/css' href='/org.css'/>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href=""> UP </a>
 |
 <a accesskey="H" href="index.html"> HOME </a>
</div><div id="preamble" class="status">
<p>▼ 本文更新于 <span class="timestamp-wrapper"><span class="timestamp">[2026-01-06 周二 17:34]</span></span></p>
</div>
<div id="content" class="content">
<header>
<h1 class="title">为rime输入方案添加语言模型支持</h1>
</header><p>
<span class="timestamp-wrapper"><time class="timestamp" datetime="2024-12-16T11:53:00">[2024-12-16 周一 11:53]</time></span><br>
</p>

<p>
语言模型可以让造句更加符合习惯，参考<a href="https://www.v2ex.com/t/1097614?p=1#reply15">V2EX的这个帖子</a>，没有语言模型的情况下基本就是胡乱组词。<br>
</p>

<p>
语言模型和输入方案是解耦的，可以使用自己习惯的rime-ice/rime-frost等方案，然后：<br>
</p>
<div id="outline-container-org4e8ec06" class="outline-2">
<h2 id="org4e8ec06"><span class="section-number-2">1.</span> 下载模型</h2>
<div class="outline-text-2" id="text-1">
<p>
在<a href="https://github.com/amzxyz/RIME-LMDG/releases">LMDG的发布页</a>下载模型。<br>
</p>

<blockquote>
<p>
模型文件版本说明：v是版本号，n是模型级别，m是百兆尺寸<br>
</p>
<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">文件大小</th>
<th scope="col" class="org-left">2级模型</th>
<th scope="col" class="org-left">3级模型</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">100M</td>
<td class="org-left">v1n2m1</td>
<td class="org-left">v1n3m1</td>
</tr>

<tr>
<td class="org-left">200M</td>
<td class="org-left">v1n2m2</td>
<td class="org-left">v1n3m2</td>
</tr>

<tr>
<td class="org-left">300M</td>
<td class="org-left">v1n2m3</td>
<td class="org-left">v1n3m3</td>
</tr>
</tbody>
</table>
</blockquote>

<p>
这里的模型级别指训练时着重训练的几个字：<br>
</p>

<blockquote>
<p>
多级 n-gram 语言模型 在大规模数据的支持下，我们采用了 n-gram 模型进行多级语言建模。具体包括了 unigram（单字模型）、bigram（双字模型）、trigram（三字模型）以及更高级的四字模型。<br>
</p>
</blockquote>

<p>
个人使用可以用n3，如果电脑性能不佳感觉卡顿，可以切换到n2（在作者的<a href="https://github.com/amzxyz/rime_wanxiang_pro/blob/main/amz-v3n2m1-zh-hans.gram">另一个方案</a>中，上传有v3n2的模型）。<br>
</p>
</div>
</div>
<div id="outline-container-orgb9f4b8b" class="outline-2">
<h2 id="orgb9f4b8b"><span class="section-number-2">2.</span> 更新配置文件</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org0100771" class="outline-3">
<h3 id="org0100771"><span class="section-number-3">2.1.</span> 找到使用的方案</h3>
<div class="outline-text-3" id="text-2-1">
<p>
打开你的Rime配置文件路径/用户文件夹，将下载好的模型文件 <code>amz-v*n*m*-**.gram</code> 放到其中。这里我下载的模型是 <code>amz-v2n3m1-zh-hans</code> <br>
</p>

<p>
Windows上可通过右键托盘小狼毫图标-用户文件夹打开（一般为 <code>%AppData%\Roaming\Rime</code> ）；MacOS上一般为 <code>~/Library/Rime</code> 。<br>
</p>

<p>
然后打开你使用的配置文件 <code>default.custom.yaml</code> （或 <code>default.yaml</code> ，当两个文件都存在时以 <code>custom.yaml</code> 为优先），寻找其中 <code>schema_list:</code> 下面的内容。<br>
</p>

<p>
比如我的 <code>default.custom.yaml</code> 就是这部分：<br>
</p>

<div class="org-src-container">
<pre class="src src-yaml"><code><span style="color: #007a9f;">patch</span>:
  <span style="color: #007a9f;">schema_list</span>:
  <span style="color: #c67fcd39a1f4;"> </span> - {<span style="color: #007a9f;">schema</span>: rime_frost_double_pinyin_flypy}
</code></pre>
</div>

<p>
说明我只用了 <code>rime_frost_double_pinyin_flypy</code> 这一个方案。<br>
</p>

<p>
以默认的 <code>default.yaml</code> 为例，它是这样的：<br>
</p>

<div class="org-src-container">
<pre class="src src-yaml"><code><span style="color: #007a9f;">schema_list</span>:
  <span style="color: #8f6f4a;"># </span><span style="color: #8f6f4a;">&#21487;&#20197;&#30452;&#25509;&#21024;&#38500;&#25110;&#27880;&#37322;&#19981;&#38656;&#35201;&#30340;&#26041;&#26696;&#65292;&#23545;&#24212;&#30340; *.schema.yaml &#26041;&#26696;&#25991;&#20214;&#20063;&#21487;&#20197;&#30452;&#25509;&#21024;&#38500;
</span>  - <span style="color: #007a9f;">schema</span>: rime_frost             <span style="color: #8f6f4a;"># </span><span style="color: #8f6f4a;">&#30333;&#38684;&#25340;&#38899;&#65288;&#20840;&#25340;&#65289;
</span>  - <span style="color: #007a9f;">schema</span>: rime_frost_double_pinyin          <span style="color: #8f6f4a;"># </span><span style="color: #8f6f4a;">&#33258;&#28982;&#30721;&#21452;&#25340;
</span>  - <span style="color: #007a9f;">schema</span>: rime_frost_double_pinyin_mspy     <span style="color: #8f6f4a;"># </span><span style="color: #8f6f4a;">&#24494;&#36719;&#21452;&#25340;
</span>  - <span style="color: #007a9f;">schema</span>: rime_frost_double_pinyin_sogou    <span style="color: #8f6f4a;"># </span><span style="color: #8f6f4a;">&#25628;&#29399;&#21452;&#25340;
</span>  - <span style="color: #007a9f;">schema</span>: rime_frost_double_pinyin_flypy    <span style="color: #8f6f4a;"># </span><span style="color: #8f6f4a;">&#23567;&#40548;&#21452;&#25340;</span>
</code></pre>
</div>

<p>
说明它启用了这五个方案（不列举了）。<br>
</p>
</div>
</div>
<div id="outline-container-orgb06024c" class="outline-3">
<h3 id="orgb06024c"><span class="section-number-3">2.2.</span> 更新方案配置文件</h3>
<div class="outline-text-3" id="text-2-2">
<p>
总之找到你要用的方案名称，然后对该配置文件打补丁。以 <code>rime_frost_double_pinyin_flypy</code> 方案为例，打开或新建 <code>rime_frost_double_pinyin_flypy.custom.yaml</code> 文件，然后加上这几行：<br>
</p>

<div class="org-src-container">
<pre class="src src-yaml"><code><span style="color: #007a9f;">patch</span>:
  <span style="color: #007a9f;">grammar</span>:
  <span style="color: #c67fcd39a1f4;"> </span> <span style="color: #007a9f;">language</span>: amz-v2n3m1-zh-hans  
  <span style="color: #c67fcd39a1f4;"> </span> <span style="color: #007a9f;">collocation_max_length</span>: 5
  <span style="color: #c67fcd39a1f4;"> </span> <span style="color: #007a9f;">collocation_min_length</span>: 2
  <span style="color: #007a9f;">translator/contextual_suggestions</span>: <span style="color: #00824f;">true</span>
  <span style="color: #007a9f;">translator/max_homophones</span>: 7
  <span style="color: #007a9f;">translator/max_homographs</span>: 7
</code></pre>
</div>

<p>
其中 <code>amz-v2n3m1-zh-hans</code> 为下载好的模型文件名（无后缀名）。然后保存，重新部署，便能享受语言模型了。<br>
</p>
</div>
</div>
</div>
<div id="outline-container-org0f5bcce" class="outline-2">
<h2 id="org0f5bcce"><span class="section-number-2">3.</span> 效果展示</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-orga10ba9f" class="outline-3">
<h3 id="orga10ba9f"><span class="section-number-3">3.1.</span> 渐渐地就不在意了</h3>
<div class="outline-text-3" id="text-3-1">
<p>
使用前：<br>
</p>

<img src="https://s2.loli.net/2024/12/14/MRPXo1cObLyfDwW.png"/>

<p>
（「不/在意/了」被理解成了「不再/一乐」）<br>
</p>

<p>
使用后：<br>
</p>

<img src="https://p.sda1.dev/20/bdbf9bbcdcdde62b0ca2f028e7cc971e/1.webp" />
</div>
</div>
<div id="outline-container-org5a92e66" class="outline-3">
<h3 id="org5a92e66"><span class="section-number-3">3.2.</span> 以前就会这样</h3>
<div class="outline-text-3" id="text-3-2">
<p>
使用前：<br>
</p>

<img src="https://s2.loli.net/2024/12/14/Y4N5CSKGTzm7oew.png"/>

<p>
（「以前/就会」被理解成了「一千九/会」）<br>
</p>

<p>
使用后：<br>
</p>
<img src="https://p.sda1.dev/20/7793862a47af23c9c149dfc37d3c45fe/2.webp" />
</div>
</div>
<div id="outline-container-org6af8be0" class="outline-3">
<h3 id="org6af8be0"><span class="section-number-3">3.3.</span> 不管怎么使劲都不行</h3>
<div class="outline-text-3" id="text-3-3">
<p>
使用前：<br>
</p>

<img src="https://s2.loli.net/2024/12/14/h6S7y1X32WHCigs.png"/>

<p>
（「不管怎么/使劲/都/不行」 =&gt; 「不管怎么/是/筋斗/不行」）<br>
</p>

<p>
使用后：<br>
</p>

<img src="https://p.sda1.dev/20/891faeb694c26acf4885c68dc650b1cc/3.webp" />
</div>
</div>
<div id="outline-container-org7380699" class="outline-3">
<h3 id="org7380699"><span class="section-number-3">3.4.</span> 无论如何你都不可能再离开这里了</h3>
<div class="outline-text-3" id="text-3-4">
<p>
使用前：<br>
</p>

<img src="https://s2.loli.net/2024/12/14/FRSr3BV6IZNY9J2.png"/>

<p>
（「离开/这里/了」 =&gt; 「离开/这/离了」）<br>
</p>

<p>
使用后：<br>
</p>

<img src="https://p.sda1.dev/20/fd570045406dedd406a42bfa5b4e506a/4.webp" />
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p>© Published by <a href="https://www.gnu.org/software/emacs/">Emacs</a> 31.0.50 (<a href="https://orgmode.org">Org</a> mode 9.8-pre)　|　<a href="https://tomoemami.github.io/rss.xml">RSS</a>　<a href="https://tomoemami.github.io/20251121T151653--english-post-index__wiki.html">English-Index</a></p>
</div>
</body>
</html>
